function initializeGalleryImages(){document.querySelectorAll(".gallery-item").forEach((e,t)=>{const n=e.querySelector("picture");if(!n)return;const o=n.querySelector("source"),i=n.querySelector("img");if(!o||!i)return;showLoadingState(i);const r=getWebPUrl(t+1),l=getFallbackUrl(t+1);console.log(`Loading optimized images for album ${t+1}:`,{webp:r,fallback:l}),loadOptimizedImage(o,i,r,l)})}function initializeGallerySlider(){const e=document.querySelector(".gallery-slider");if(!e)return;const t=e.querySelector(".slider-viewport"),n=e.querySelector(".slider-track"),o=Array.from(e.querySelectorAll(".gallery-item")),i=e.querySelector(".slider-btn.prev"),r=e.querySelector(".slider-btn.next");if(!t||!n||0===o.length)return;let l=0,s=0,a=0,c=0;const d=parseFloat(e.dataset.speed||"50");let u=window.innerWidth>768,g=!1;function f(){return window.innerWidth<=768?1:window.innerWidth<=1024?2:3}function m(){const e=f();if(1===e){const e=Math.round(t.getBoundingClientRect().width);l=Math.floor(.73*e),o.forEach(e=>{e.style.minWidth=`${l}px`,e.style.maxWidth=`${l}px`,e.style.flex=`0 0 ${l}px`})}else{const n=(t.clientWidth-24*(e-1))/e;l=Math.min(Math.round(n),400),o.forEach(e=>{e.style.minWidth=`${l}px`,e.style.maxWidth=`${l}px`,e.style.flex=`0 0 ${l}px`})}w()}function p(e){if(!u)return;c||(c=e);const t=e-c;if(c=e,window.innerWidth>768){const e=l+24;a+=d*t/1e3;let o=!1;for(;a>=e;)n.appendChild(n.firstElementChild),a-=e,o=!0;if(o){const e=n.style.transition;n.style.transition="none",n.style.transform=`translateX(${-a}px)`,requestAnimationFrame(()=>{n.style.transition=e||"transform 300ms linear"})}else n.style.transition="transform 300ms linear",n.style.transform=`translateX(${-a}px)`}requestAnimationFrame(p)}function y(){u=!1,c=0}function h(){u||(u=!0,requestAnimationFrame(p))}function w(){const e=-s*(l+24);n.style.transition=g?"none":"transform 300ms ease-out",n.style.transform=`translateX(${e-a}px)`}function v(e){const t=f(),n=o.length;s=(s+e*t+n)%n,a=0,w()}window.addEventListener("resize",()=>{m()}),r?.addEventListener("click",()=>{y(),v(1)}),i?.addEventListener("click",()=>{y(),v(-1)}),t.addEventListener("mouseenter",y),t.addEventListener("mouseleave",()=>{window.innerWidth>768&&h()});let S=!1,b=0,E=0,q=0,x=!1,L=null;function C(e){e.target&&"function"==typeof e.target.closest&&e.target.closest("a")||(S=!0,x=!1,g=!1,L=null,t.classList.remove("dragging"),b=(e.touches?e.touches[0].clientX:e.clientX)||0,E=(e.touches?e.touches[0].clientY:e.clientY)||0,q=0,a=0)}function k(e){if(!S)return;const n=(e.touches?e.touches[0].clientX:e.clientX)||0,i=(e.touches?e.touches[0].clientY:e.clientY)||0,r=b-n,c=E-i,d=Math.abs(r),u=Math.abs(c);if(!L){if(!(d>6||u>6))return;L=d>u?"x":"y","x"===L?(g=!0,t.classList.add("dragging"),t.setPointerCapture?.(e.pointerId),y()):(g=!1,t.classList.remove("dragging"))}if("y"===L)return;d>3&&(x=!0),x&&e.preventDefault&&e.preventDefault();const f=l+24;a=r,r>f/2&&(s=(s+1)%o.length,b=n,a=0),r<-f/2&&(s=(s-1+o.length)%o.length,b=n,a=0),w()}function z(){S&&(S=!1,g=!1,t.classList.remove("dragging"),L=null,a=0,w(),window.innerWidth>768&&h())}t.addEventListener("pointerdown",C,{passive:!1}),t.addEventListener("pointermove",k,{passive:!1}),t.addEventListener("pointerup",z,{passive:!1}),t.addEventListener("pointercancel",z,{passive:!1}),t.addEventListener("touchstart",C,{passive:!1}),t.addEventListener("touchmove",k,{passive:!1}),t.addEventListener("touchend",z,{passive:!1}),m(),window.innerWidth>768&&requestAnimationFrame(p)}function showLoadingState(e){e.style.opacity="0.3",e.style.filter="blur(2px)";const t=document.createElement("div");t.className="image-loading-spinner",t.innerHTML="ðŸ”„",t.style.cssText="\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    font-size: 24px;\n    z-index: 10;\n    animation: spin 1s linear infinite;\n  ",e.parentElement.style.position="relative",e.parentElement.appendChild(t)}function loadOptimizedImage(e,t,n,o){console.log("Loading optimized images:",{webp:n,fallback:o});const i=new Image;i.onload=function(){console.log("WebP loaded successfully:",n),e.srcset=n,t.style.opacity="1",t.style.filter="none";const i=t.parentElement.querySelector(".image-loading-spinner");i&&i.remove(),t.src=o},i.onerror=function(){console.log("WebP failed, loading fallback:",o),loadFallbackImage(t,o)},i.src=n}function loadFallbackImage(e,t){const n=new Image;n.onload=function(){console.log("Fallback image loaded successfully:",t),e.style.opacity="1",e.style.filter="none";const n=e.parentElement.querySelector(".image-loading-spinner");n&&n.remove(),e.src=t},n.onerror=function(){console.log("Fallback image failed to load:",t),e.style.opacity="1",e.style.filter="none";const n=e.parentElement.querySelector(".image-loading-spinner");n&&n.remove(),e.style.display="none"},n.src=t}function getWebPUrl(e){const t="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname||"5500"===window.location.port||"file:"===window.location.protocol,n=`assets/images/gallery-preview-${e}.webp`;return console.log(`Loading WebP ${e}:`,n,"isLocalhost:",t),n}function getFallbackUrl(e){const t="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname||"5500"===window.location.port||"file:"===window.location.protocol,n=`assets/images/gallery-preview-${e}.jpg`;return console.log(`Loading fallback ${e}:`,n,"isLocalhost:",t),n}function initializeSmoothScrolling(){console.log("Initializing enhanced smooth scrolling");const e={duration:800,easing:"easeInOutCubic",offset:80,tolerance:5};function t(t,n={}){const o={...e,...n},i=window.pageYOffset,r=t.offsetTop-o.offset,l=r-i,s=performance.now();Math.abs(l)<o.tolerance||requestAnimationFrame(function e(t){const n=t-s,a=Math.min(n/o.duration,1),c=(d=a)<.5?4*d*d*d:1-Math.pow(-2*d+2,3)/2;var d;window.scrollTo(0,i+l*c),a<1?requestAnimationFrame(e):window.scrollTo(0,r)})}let n;document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",n=>{const o=e.getAttribute("href");if(!o||o.length<2)return;const i=document.querySelector(o);i&&(n.preventDefault(),document.querySelectorAll('a[href^="#"]').forEach(e=>e.classList.remove("active")),e.classList.add("active"),t(i),history.pushState(null,null,o))})}),document.querySelectorAll("[data-scroll-to]").forEach(e=>{e.addEventListener("click",n=>{const o=e.getAttribute("data-scroll-to"),i=document.querySelector(o);i&&(n.preventDefault(),t(i))})}),window.addEventListener("scroll",()=>{clearTimeout(n),n=setTimeout(()=>{!function(){const t=document.querySelectorAll("section[id]"),n=document.querySelectorAll('a[href^="#"]');let o="";const i=window.pageYOffset+e.offset+100;t.forEach(e=>{const t=e.offsetTop,n=e.offsetHeight;i>=t&&i<t+n&&(o=e.getAttribute("id"))}),n.forEach(e=>{e.classList.remove("active"),e.getAttribute("href")===`#${o}`&&e.classList.add("active")})}(),function(){const e=document.querySelector(".scroll-indicator");if(!e)return;const t=window.pageYOffset,n=document.documentElement.scrollHeight-window.innerHeight,o=t/n*100;e.style.transform=`scaleX(${o/100})`}()},100)}),document.querySelectorAll('.btn[href^="#"]').forEach(e=>{e.addEventListener("click",n=>{const o=e.getAttribute("href"),i=document.querySelector(o);i&&(n.preventDefault(),e.style.transform="scale(0.95)",setTimeout(()=>{e.style.transform="scale(1)"},150),t(i,{duration:1e3}))})}),console.log("Enhanced smooth scrolling initialized")}function initializeCountdownTimer(){console.log("Initializing countdown timer");const e=new Date("November 15, 2025 23:59:59").getTime(),t=document.getElementById("countdown-days"),n=document.getElementById("countdown-hours"),o=document.getElementById("countdown-minutes"),i=document.getElementById("countdown-seconds");function r(){const r=(new Date).getTime(),l=e-r;if(l<0){t.textContent="00",n.textContent="00",o.textContent="00",i.textContent="00";const e=document.querySelector(".urgency-container");return void(e&&(e.innerHTML='\n          <div class="spots-urgency">\n            <div class="spots-counter-large">\n              <div class="counter-number-large">ðŸ”’</div>\n              <div class="counter-label-large">Inscripciones Cerradas</div>\n            </div>\n            <div class="urgency-message">\n              <p class="spots-left">El perÃ­odo de inscripciÃ³n ha finalizado</p>\n              <p class="guarantee">Â¡Gracias por tu interÃ©s en nuestra expediciÃ³n!</p>\n            </div>\n          </div>\n          \n          <div class="unified-cta">\n            <p class="urgency-text">Mantente atento a nuestras prÃ³ximas aventuras</p>\n            <a class="btn btn-secondary" href="https://www.instagram.com/4x4traveleje/" target="_blank" rel="noopener noreferrer">\n              SÃ­guenos en Instagram â†’\n            </a>\n          </div>\n        ',e.style.background="linear-gradient(135deg, rgba(220, 38, 38, 0.08), rgba(185, 28, 28, 0.08))"))}const s=Math.floor(l/864e5),a=Math.floor(l%864e5/36e5),c=Math.floor(l%36e5/6e4),d=Math.floor(l%6e4/1e3);if(t.textContent=s.toString().padStart(2,"0"),n.textContent=a.toString().padStart(2,"0"),o.textContent=c.toString().padStart(2,"0"),i.textContent=d.toString().padStart(2,"0"),0===s&&a<24){const e=document.querySelector(".urgency-container");e&&(e.style.animation="countdownPulse 1s ease-in-out infinite",e.style.background="linear-gradient(135deg, rgba(220, 38, 38, 0.12), rgba(185, 28, 28, 0.12))")}if(0===s&&0===a&&c<60){const e=document.querySelector(".urgency-container");e&&(e.style.animation="countdownPulse 0.5s ease-in-out infinite")}}t&&n&&o&&i?(r(),setInterval(r,1e3),console.log("Countdown timer initialized")):console.error("Countdown elements not found")}function initializeStickyCTA(){console.log("Initializing sticky CTA behavior");const e=document.querySelector(".sticky-whatsapp-cta"),t=document.querySelector(".footer-section");function n(){const n=t.offsetTop;window.pageYOffset+window.innerHeight>n-e.offsetHeight-20?(e.style.opacity="0",e.style.transform="translateY(20px)",e.style.pointerEvents="none"):(e.style.opacity="1",e.style.transform="translateY(0)",e.style.pointerEvents="auto")}e&&t?(window.addEventListener("scroll",()=>{requestAnimationFrame(n)}),window.addEventListener("resize",()=>{requestAnimationFrame(n)}),e.addEventListener("click",t=>{t.target.closest(".sticky-whatsapp-btn")&&(e.style.transform="scale(0.95)",setTimeout(()=>{e.style.transform="scale(1)"},150))}),console.log("Sticky CTA behavior initialized")):console.error("Sticky CTA or footer not found")}function initializeScrollReveal(){if(window.matchMedia("(prefers-reduced-motion: reduce)").matches)return;const e=document.querySelectorAll(".reveal");if(!e.length)return;const t=new IntersectionObserver((e,t)=>{e.forEach(e=>{if(e.isIntersecting){const n=e.target;n.offsetWidth,n.classList.add("in-view"),t.unobserve(n)}})},{rootMargin:"0px 0px -10% 0px",threshold:.1});e.forEach(e=>t.observe(e))}document.addEventListener("DOMContentLoaded",function(){console.log("DOM loaded - Starting enhanced slider");"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname||"5500"===window.location.port||window.location.protocol;const e="assets/";if(document.querySelectorAll("picture").forEach(t=>{const n=t.querySelector("source[data-srcset]"),o=t.querySelector("img[data-src]");n&&o&&(n.srcset=e+n.dataset.srcset,o.src=e+o.dataset.src)}),document.querySelectorAll("img[data-src]:not(picture img)").forEach(t=>{t.src=e+t.dataset.src}),setTimeout(()=>function(){const t=document.querySelector(".hero-background-slider");if(!t)return void console.log("Slider element not found");if("true"===t.dataset.initialized)return void console.log("Slider already initialized, skipping");t.dataset.initialized="true";const n=["images/hero_1.webp","images/hero_2.webp","images/hero_3.webp"];let o=0,i=!1;function r(){if(i)return;i=!0,o=(o+1)%n.length;const r=e+n[o];console.log(`Slider: Changing to image ${o+1}/${n.length} - ${n[o]}`),t.style.opacity="0",setTimeout(()=>{t.style.backgroundImage=`url('${r}')`,t.style.opacity="0.7",console.log(`Slider: Next image will be ${(o+1)%n.length+1}/${n.length} - ${n[(o+1)%n.length]}`),setTimeout(()=>{i=!1},500)},300)}const l=e+n[0];console.log(`Slider: Initial image set to ${n[0]}`),t.style.backgroundImage=`url('${l}')`,t.style.opacity="0.7",setInterval(r,6e3)}(),0),initializeSmoothScrolling(),"undefined"!=typeof ExpeditionConfig)try{const e=new ExpeditionConfig;e.loadConfig().then(()=>{e.updatePageContent(),console.log("Config loaded successfully")}).catch(e=>{console.error("Error loading config:",e)})}catch(e){console.error("Error initializing ExpeditionConfig:",e)}initializeGalleryImages(),initializeGallerySlider(),initializeCountdownTimer(),initializeStickyCTA(),initializeScrollReveal()});